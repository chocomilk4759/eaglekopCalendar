/* ============================================================================
   EAGLEKOP CALENDAR — CLEAN GLOBALS
   - Theme tokens
   - Base reset & typography
   - Layout grid
   - Calendar grid & cells (min 160x160, auto-fit columns)
   - Chips (wrap text; no horizontal scrollbar in cell)
   - Top ribbon
   - Presets dock / Auth header (hide in compact)
   - Modal basics
   - Utilities & responsive
============================================================================ */

/* ========== 1) THEME TOKENS ========== */
:root{
  --bg:#fff; --fg:#111; --muted:#666; --border:#e5e5e5; --card:#fff; --accent:#222;
  --sun:#d00; --sat:#05c;
  --flagRed:#E74C4C; --flagBlue:#4C88DB;

  /* layout */
  --dock-width:320px; --dock-gap:10px; --leftdock-width:320px; --leftdock-gap:10px;
}
[data-theme="dark"]{
  --bg:#0e0f12; --fg:#e9eaee; --muted:#a1a6b3; --border:#2a2d36; --card:#14161b; --accent:#f1f2f4;
  --sun:#ff6b6b; --sat:#6ab0ff;
}

/* ========== 2) BASE RESET ========== */
*,
*::before,
*::after{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--fg);
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
a{ color:inherit; text-decoration:none; }
button, input, textarea, select{
  color:inherit; background:var(--card); border:1px solid var(--border); border-radius:10px; padding:8px 10px; font:inherit;
}
button{ cursor:pointer; transition:background .12s ease, box-shadow .12s ease, transform .06s ease; }
button:hover{ background:rgba(0,0,0,.03); }
button:active{ transform:translateY(.5px); }
.container{ width:100%; margin:0; padding:24px; }

/* ========== 3) LAYOUT GRID (좌/우 도크 고려) ========== */
.layout-1-8-1{
  display:grid; grid-template-columns: 40px 1fr 40px; gap:16px; align-items:start;
}
.layout-1-8-1>.col-main{ min-width:0; }

/* 우측 프리셋 도크/좌측 인증 도크가 열리면 컬럼 보정 (참고용) */
html[data-dock="open"] .layout-1-8-1{
  grid-template-columns: 40px 1fr calc(var(--dock-width) + var(--dock-gap));
}
html[data-leftdock="open"] .layout-1-8-1{
  grid-template-columns: calc(var(--leftdock-width) + var(--leftdock-gap)) 1fr 40px;
}
html[data-leftdock="open"][data-dock="open"] .layout-1-8-1{
  grid-template-columns: calc(var(--leftdock-width) + var(--leftdock-gap)) 1fr calc(var(--dock-width) + var(--dock-gap));
}

/* ========== 4) CALENDAR GRID ========== */
/* 7열이 가능하면 그리드가 정확히 7칸, 아니면 auto-fit으로 칼럼 수 자동 조절 */
.calendar-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); /* 핵심: 셀 최소폭 160px */
  gap:14px;
}

/* 요일 헤더 */
.day-name{ font-size:13px; opacity:.7; text-align:center; }
.day-name.sun{ color:var(--sun); }
.day-name.sat{ color:var(--sat); }

/* 셀: 최소 160x160, 내부 콘텐츠 오버플로우 제어 */
.cell{
  position:relative;
  background:var(--card);
  border:1px solid var(--border); border-radius:12px;
  padding:10px;
  min-width:160px; min-height:160px;       /* 요구사항 */
  overflow:hidden;                          /* 가로 스크롤 가림 */
}
.cell.today{ outline:2px solid var(--flagBlue); outline-offset:2px; }
.date-lg{ font-size:15px; }
.cell .date{ font-size:14px; opacity:.7; }
.cell.sun .date{ color:var(--sun); }
.cell.sat .date{ color:var(--sat); }

/* 플래그 배경 */
.cell.flag-red{ background:var(--flagRed); border-color: color-mix(in srgb, var(--flagRed) 85%, #000 15%); }
.cell.flag-blue{ background:var(--flagBlue); border-color: color-mix(in srgb, var(--flagBlue) 85%, #000 15%); }
.cell.flag-red .date, .cell.flag-blue .date{ color:#fff; opacity:1; }
.cell .flag-banner{ display:none; }
.cell.flag-red .flag-banner, .cell.flag-blue .flag-banner{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  padding:12px; text-align:center; font-weight:800; font-size:clamp(18px,2.6vw,30px); color:#fff; pointer-events:none;
}

/* 링크 아이콘(우상단) */
.cell .link-ico{
  position:absolute; top:8px; right:8px;
  display:inline-flex; align-items:center; justify-content:center;
  width:24px; height:24px; border:1px solid var(--border); border-radius:8px;
  background:var(--card); opacity:.95;
}
.cell .link-ico:hover{ background:rgba(0,0,0,.03); }

/* ========== 5) CHIPS (줄바꿈 / 가로 스크롤 숨김) ========== */
.chips{ display:flex; gap:6px; flex-wrap:wrap; margin-top:6px; }
.chips-scroll{ max-height: calc(100% - 34px); overflow-y:auto; overflow-x:hidden; padding-right:2px; } /* 수평 스크롤 숨김 */

.chip{
  border:1px solid var(--border); border-radius:10px;
  padding:8px 10px; background:var(--card); box-shadow:0 1px 2px rgba(0,0,0,.06);
  display:inline-flex; align-items:center; gap:6px;
  max-width:100%;
}
[data-theme="dark"] .chip{ background:#171a20; box-shadow:0 1px 2px rgba(0,0,0,.4); border-color:#2a2d36; }

.chip-emoji{ flex:0 0 auto; }
.chip-text{
  min-width:0;
  white-space:normal;            /* ← 줄바꿈 허용 */
  word-break:break-word;
  overflow-wrap:anywhere;
}

/* 플래그 대비 */
.cell.flag-red .chip, .cell.flag-blue .chip{
  background:rgba(255,255,255,.16); border-color:rgba(255,255,255,.35); color:#fff;
}

/* ========== 6) TOP RIBBON(간단) ========== */
.top-ribbon{ display:flex; align-items:center; gap:16px; padding:10px 12px; margin:6px 0 14px; background:var(--card); border:1px solid var(--border); border-radius:12px; box-shadow:0 6px 16px rgba(0,0,0,.06); }
.ribbon-text{ font-weight:700; opacity:.9; white-space:nowrap; }
.ribbon-date{ color:var(--muted); font-weight:700; }
.top-ribbon-buttons{ display:flex; gap:10px; overflow:hidden; padding:4px; }
.top-btn{ border:none; background:transparent; padding:0; border-radius:12px; flex:0 0 auto; }
.top-btn img{ display:block; height:64px; width:auto; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,.08); }
@media (max-width:640px){ .top-btn img{ height:56px; } }

/* ========== 7) PRESETS DOCK & AUTH HEADER (compact 모드에서 숨김) ========== */
.presets-dock{ position:fixed; right:12px; top:84px; z-index:9990; width:var(--dock-width); max-height:calc(100vh - 72px); display:flex; flex-direction:column; gap:8px; overflow:hidden; background:var(--card); border:1px solid var(--border); border-radius:12px; padding:8px; box-shadow:0 6px 16px rgba(0,0,0,.06); }
.presets-dock.collapsed{ width:52px; }
/* compact: 7칸 불가 시 숨김(공간도 차지 X) */
html[data-compact="1"] .presets-dock{ display:none !important; }
html[data-compact="1"] .header-fixed{ display:none !important; }  /* AuthButton 배치 영역 통째로 숨김 */

/* ========== 8) MODAL 기본 ========== */
.modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:10000; }
.modal .sheet{ width:min(720px,95vw); background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px; box-shadow:0 18px 48px rgba(0,0,0,.22); }
.modal .bar{ display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }

/* ========== 9) UTILS & RESPONSIVE ========== */
.text-muted{ color:var(--muted); }
.text-center{ text-align:center; }
.round{ border-radius:999px; }
.hidden{ display:none !important; }

@media (max-width:980px){
  .container{ padding:16px; }
  .layout-1-8-1{ grid-template-columns:1fr; }   /* 세로 스택 */
}
@media (max-width:640px){
  .modal .sheet{ width:92vw; }
}
